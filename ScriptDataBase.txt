
CREATE TABLE PESSOA (
                HANDLE INTEGER NOT NULL,
                STATUSDATA TIMESTAMP
                STATUS INTEGER,
                LOGUSUARIOALTERACAO INTEGER,
                LOGDATACADASTRO TIMESTAMP,
                LOGDATAALTERACAO TIMESTAMP,
                LOGUSUARIOCADASTRO INTEGER,
                NOME VARCHAR,
				ENDERECO VARCHAR,
                CNPJCPF VARCHAR,
                OBSERVACAO VARCHAR,
                CONSTRAINT handle_pessoa PRIMARY KEY (HANDLE)
);

CREATE TABLE USUARIO (
                HANDLE INTEGER NOT NULL,
                LOGIN VARCHAR,
                SENHA VARCHAR,
                STATUS INTEGER,
                STATUSDATA VARCHAR,
                LOGUSUARIOCADASTRO INTEGER,
                LOGDATAALTERACAO TIMESTAMP,
                LOGDATACADASTRO TIMESTAMP,
                LOGUSUARIOALTERACAO INTEGER,
                CONSTRAINT handle_usuario PRIMARY KEY (HANDLE)
);

CREATE TABLE VENDA (
                HANDLE INTEGER NOT NULL,
                VALORLIQUIDO NUMERIC(15,2),
                CLIENTE INTEGER,
                OBSERVACAO VARCHAR,
                DATA TIMESTAMP,
                STATUS INTEGER,
                STATUSDATA TIMESTAMP,
                VENDEDOR INTEGER,
                NUMEROPEDIDO VARCHAR,
                LOGUSUARIOCADASTRO INTEGER,
                LOGDATAALTERACAO TIMESTAMP,
                LOGDATACADASTRO TIMESTAMP,
                LOGUSUARIOALTERACAO INTEGER,
                CONSTRAINT handle_venda PRIMARY KEY (HANDLE)
);


CREATE TABLE PRODUTO (
                HANDLE INTEGER NOT NULL,
                VALOR NUMERIC(15,2),
                NOME VARCHAR,
                CODIGOAUXILIAR VARCHAR,
                ESTOQUE NUMERIC(15,4),
                DESCRICAO VARCHAR,
                LOGDATACADASTRO TIMESTAMP,
                LOGDATAALTERACAO TIMESTAMP,
                LOGUSUARIOCADASTRO INTEGER,
                LOGUSUARIOALTERACAO INTEGER,
                CONSTRAINT handle_produto PRIMARY KEY (HANDLE)
);


CREATE TABLE VENDAPRODUTO (
                HANDLE INTEGER NOT NULL,
                OBSERVACAO VARCHAR,
                PRODUTO INTEGER,
                QUANTIDADE NUMERIC(15,4),
                VALORUNITARIO NUMERIC(15,2),
                VALORTOTAL NUMERIC(15,2),
                VENDA INTEGER,
                CONSTRAINT handle_vendaproduto PRIMARY KEY (HANDLE)
);

CREATE TABLE STATUS (
                HANDLE INTEGER NOT NULL,
                NOME VARCHAR,
                CONSTRAINT handle_status PRIMARY KEY (HANDLE)
);


ALTER TABLE PESSOA ADD CONSTRAINT status_pessoa_fk
FOREIGN KEY (STATUS)
REFERENCES STATUS (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE USUARIO ADD CONSTRAINT status_usuario_fk
FOREIGN KEY (STATUS)
REFERENCES STATUS (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE VENDA ADD CONSTRAINT status_venda_fk
FOREIGN KEY (STATUS)
REFERENCES STATUS (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE VENDA ADD CONSTRAINT pessoa_venda_fk
FOREIGN KEY (CLIENTE)
REFERENCES PESSOA (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE VENDA ADD CONSTRAINT usuario_venda_fk
FOREIGN KEY (VENDEDOR)
REFERENCES USUARIO (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE VENDA ADD CONSTRAINT usuario_venda_fk1
FOREIGN KEY (LOGUSUARIOCADASTRO)
REFERENCES USUARIO (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE VENDA ADD CONSTRAINT usuario_venda_fk2
FOREIGN KEY (LOGUSUARIOALTERACAO)
REFERENCES USUARIO (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE PRODUTO ADD CONSTRAINT usuario_produto_fk
FOREIGN KEY (LOGUSUARIOCADASTRO)
REFERENCES USUARIO (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE PRODUTO ADD CONSTRAINT usuario_produto_fk1
FOREIGN KEY (LOGUSUARIOALTERACAO)
REFERENCES USUARIO (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE VENDAPRODUTO ADD CONSTRAINT venda_vendaproduto_fk
FOREIGN KEY (VENDA)
REFERENCES VENDA (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE VENDAPRODUTO ADD CONSTRAINT produto_vendaproduto_fk
FOREIGN KEY (PRODUTO)
REFERENCES PRODUTO (HANDLE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

INSERT INTO STATUS(HANDLE,NOME)
VALUES(2,'Ag. Modificações'),
(3,'Ativo'),
(4,'Cancelado'),
(5, 'Encerrado'),
(6, 'Ag. Entrega')


